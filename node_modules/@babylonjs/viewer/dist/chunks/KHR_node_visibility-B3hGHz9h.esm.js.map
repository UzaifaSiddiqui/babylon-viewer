{"version":3,"file":"KHR_node_visibility-B3hGHz9h.esm.js","sources":["../../../../../dev/loaders/dist/glTF/2.0/Extensions/KHR_node_visibility.js"],"sourcesContent":["import { registerGLTFExtension, unregisterGLTFExtension } from \"../glTFLoaderExtensionRegistry\";\nimport { AddObjectAccessorToKey } from \"./objectModelMapping\";\nconst NAME = \"KHR_node_visibility\";\n// object model extension for visibility\nAddObjectAccessorToKey(\"/nodes/{}/extensions/KHR_node_visibility/visible\", {\n    get: (node) => {\n        const tn = node._babylonTransformNode;\n        if (tn && tn.isVisible !== undefined) {\n            return tn.isVisible;\n        }\n        return true;\n    },\n    set: (value, node) => {\n        node._primitiveBabylonMeshes?.forEach((mesh) => {\n            mesh.inheritVisibility = true;\n        });\n        if (node._babylonTransformNode) {\n            node._babylonTransformNode.isVisible = value;\n        }\n        node._primitiveBabylonMeshes?.forEach((mesh) => {\n            mesh.isVisible = value;\n        });\n    },\n    getTarget: (node) => node._babylonTransformNode,\n    getPropertyName: [() => \"isVisible\"],\n    type: \"boolean\",\n});\n/**\n * Loader extension for KHR_node_visibility\n */\n// eslint-disable-next-line @typescript-eslint/naming-convention\nexport class KHR_node_visibility {\n    /**\n     * @internal\n     */\n    constructor(loader) {\n        /**\n         * The name of this extension.\n         */\n        this.name = NAME;\n        this._loader = loader;\n        this.enabled = loader.isExtensionUsed(NAME);\n    }\n    // eslint-disable-next-line @typescript-eslint/naming-convention, @typescript-eslint/no-misused-promises\n    async onReady() {\n        this._loader.gltf.nodes?.forEach((node) => {\n            node._primitiveBabylonMeshes?.forEach((mesh) => {\n                mesh.inheritVisibility = true;\n            });\n            // When the JSON Pointer is used we need to change both the transform node and the primitive meshes to the new value.\n            if (node.extensions?.KHR_node_visibility) {\n                if (node.extensions?.KHR_node_visibility.visible === false) {\n                    if (node._babylonTransformNode) {\n                        node._babylonTransformNode.isVisible = false;\n                    }\n                    node._primitiveBabylonMeshes?.forEach((mesh) => {\n                        mesh.isVisible = false;\n                    });\n                }\n            }\n        });\n    }\n    dispose() {\n        this._loader = null;\n    }\n}\nunregisterGLTFExtension(NAME);\nregisterGLTFExtension(NAME, true, (loader) => new KHR_node_visibility(loader));\n//# sourceMappingURL=KHR_node_visibility.js.map"],"names":[],"mappings":";;;AAEA,MAAM,IAAI,GAAG,qBAAqB;AAClC;AACA,sBAAsB,CAAC,kDAAkD,EAAE;AAC3E,IAAI,GAAG,EAAE,CAAC,IAAI,KAAK;AACnB,QAAQ,MAAM,EAAE,GAAG,IAAI,CAAC,qBAAqB;AAC7C,QAAQ,IAAI,EAAE,IAAI,EAAE,CAAC,SAAS,KAAK,SAAS,EAAE;AAC9C,YAAY,OAAO,EAAE,CAAC,SAAS;AAC/B;AACA,QAAQ,OAAO,IAAI;AACnB,KAAK;AACL,IAAI,GAAG,EAAE,CAAC,KAAK,EAAE,IAAI,KAAK;AAC1B,QAAQ,IAAI,CAAC,uBAAuB,EAAE,OAAO,CAAC,CAAC,IAAI,KAAK;AACxD,YAAY,IAAI,CAAC,iBAAiB,GAAG,IAAI;AACzC,SAAS,CAAC;AACV,QAAQ,IAAI,IAAI,CAAC,qBAAqB,EAAE;AACxC,YAAY,IAAI,CAAC,qBAAqB,CAAC,SAAS,GAAG,KAAK;AACxD;AACA,QAAQ,IAAI,CAAC,uBAAuB,EAAE,OAAO,CAAC,CAAC,IAAI,KAAK;AACxD,YAAY,IAAI,CAAC,SAAS,GAAG,KAAK;AAClC,SAAS,CAAC;AACV,KAAK;AACL,IAAI,SAAS,EAAE,CAAC,IAAI,KAAK,IAAI,CAAC,qBAAqB;AACnD,IAAI,eAAe,EAAE,CAAC,MAAM,WAAW,CAAC;AACxC,IAAI,IAAI,EAAE,SAAS;AACnB,CAAC,CAAC;AACF;AACA;AACA;AACA;AACO,MAAM,mBAAmB,CAAC;AACjC;AACA;AACA;AACA,IAAI,WAAW,CAAC,MAAM,EAAE;AACxB;AACA;AACA;AACA,QAAQ,IAAI,CAAC,IAAI,GAAG,IAAI;AACxB,QAAQ,IAAI,CAAC,OAAO,GAAG,MAAM;AAC7B,QAAQ,IAAI,CAAC,OAAO,GAAG,MAAM,CAAC,eAAe,CAAC,IAAI,CAAC;AACnD;AACA;AACA,IAAI,MAAM,OAAO,GAAG;AACpB,QAAQ,IAAI,CAAC,OAAO,CAAC,IAAI,CAAC,KAAK,EAAE,OAAO,CAAC,CAAC,IAAI,KAAK;AACnD,YAAY,IAAI,CAAC,uBAAuB,EAAE,OAAO,CAAC,CAAC,IAAI,KAAK;AAC5D,gBAAgB,IAAI,CAAC,iBAAiB,GAAG,IAAI;AAC7C,aAAa,CAAC;AACd;AACA,YAAY,IAAI,IAAI,CAAC,UAAU,EAAE,mBAAmB,EAAE;AACtD,gBAAgB,IAAI,IAAI,CAAC,UAAU,EAAE,mBAAmB,CAAC,OAAO,KAAK,KAAK,EAAE;AAC5E,oBAAoB,IAAI,IAAI,CAAC,qBAAqB,EAAE;AACpD,wBAAwB,IAAI,CAAC,qBAAqB,CAAC,SAAS,GAAG,KAAK;AACpE;AACA,oBAAoB,IAAI,CAAC,uBAAuB,EAAE,OAAO,CAAC,CAAC,IAAI,KAAK;AACpE,wBAAwB,IAAI,CAAC,SAAS,GAAG,KAAK;AAC9C,qBAAqB,CAAC;AACtB;AACA;AACA,SAAS,CAAC;AACV;AACA,IAAI,OAAO,GAAG;AACd,QAAQ,IAAI,CAAC,OAAO,GAAG,IAAI;AAC3B;AACA;AACA,uBAAuB,CAAC,IAAI,CAAC;AAC7B,qBAAqB,CAAC,IAAI,EAAE,IAAI,EAAE,CAAC,MAAM,KAAK,IAAI,mBAAmB,CAAC,MAAM,CAAC,CAAC;;;;"}