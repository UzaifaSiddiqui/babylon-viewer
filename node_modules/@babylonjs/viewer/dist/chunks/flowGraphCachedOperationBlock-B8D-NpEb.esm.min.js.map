{"version":3,"file":"flowGraphCachedOperationBlock-B8D-NpEb.esm.min.js","sources":["../../../../../dev/core/dist/FlowGraph/Blocks/Data/flowGraphCachedOperationBlock.js"],"sourcesContent":["import { FlowGraphBlock } from \"../../flowGraphBlock\";\nimport { RichTypeBoolean } from \"../../flowGraphRichTypes\";\nconst CacheName = \"cachedOperationValue\";\nconst CacheExecIdName = \"cachedExecutionId\";\n/**\n * A block that will cache the result of an operation and deliver it as an output.\n */\nexport class FlowGraphCachedOperationBlock extends FlowGraphBlock {\n    constructor(outputRichType, config) {\n        super(config);\n        this.value = this.registerDataOutput(\"value\", outputRichType);\n        this.isValid = this.registerDataOutput(\"isValid\", RichTypeBoolean);\n    }\n    _updateOutputs(context) {\n        const cachedExecutionId = context._getExecutionVariable(this, CacheExecIdName, -1);\n        const cachedValue = context._getExecutionVariable(this, CacheName, null);\n        if (cachedValue !== undefined && cachedValue !== null && cachedExecutionId === context.executionId) {\n            this.isValid.setValue(true, context);\n            this.value.setValue(cachedValue, context);\n        }\n        else {\n            try {\n                const calculatedValue = this._doOperation(context);\n                if (calculatedValue === undefined || calculatedValue === null) {\n                    this.isValid.setValue(false, context);\n                    return;\n                }\n                context._setExecutionVariable(this, CacheName, calculatedValue);\n                context._setExecutionVariable(this, CacheExecIdName, context.executionId);\n                this.value.setValue(calculatedValue, context);\n                this.isValid.setValue(true, context);\n            }\n            catch (e) {\n                this.isValid.setValue(false, context);\n            }\n        }\n    }\n}\n//# sourceMappingURL=flowGraphCachedOperationBlock.js.map"],"names":["CacheName","CacheExecIdName","FlowGraphCachedOperationBlock","FlowGraphBlock","constructor","outputRichType","config","super","this","value","registerDataOutput","isValid","RichTypeBoolean","_updateOutputs","context","cachedExecutionId","_getExecutionVariable","cachedValue","executionId","setValue","calculatedValue","_doOperation","_setExecutionVariable","e"],"mappings":"wHAEA,MAAMA,EAAY,uBACZC,EAAkB,oBAIjB,MAAMC,UAAsCC,EAC/C,WAAAC,CAAYC,EAAgBC,GACxBC,MAAMD,GACNE,KAAKC,MAAQD,KAAKE,mBAAmB,QAASL,GAC9CG,KAAKG,QAAUH,KAAKE,mBAAmB,UAAWE,EAC1D,CACI,cAAAC,CAAeC,GACX,MAAMC,EAAoBD,EAAQE,sBAAsBR,KAAMP,GAAiB,GACzEgB,EAAcH,EAAQE,sBAAsBR,KAAMR,EAAW,MACnE,GAAIiB,SAAqDF,IAAsBD,EAAQI,YACnFV,KAAKG,QAAQQ,UAAS,EAAML,GAC5BN,KAAKC,MAAMU,SAASF,EAAaH,QAGjC,IACI,MAAMM,EAAkBZ,KAAKa,aAAaP,GAC1C,GAAIM,QAEA,YADAZ,KAAKG,QAAQQ,UAAS,EAAOL,GAGjCA,EAAQQ,sBAAsBd,KAAMR,EAAWoB,GAC/CN,EAAQQ,sBAAsBd,KAAMP,EAAiBa,EAAQI,aAC7DV,KAAKC,MAAMU,SAASC,EAAiBN,GACrCN,KAAKG,QAAQQ,UAAS,EAAML,EAC5C,CACY,MAAOS,GACHf,KAAKG,QAAQQ,UAAS,EAAOL,EAC7C,CAEA"}