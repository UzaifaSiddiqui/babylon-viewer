{"version":3,"file":"flowGraphTransformCoordinatesSystemBlock-rNQ7UuUn.esm.js","sources":["../../../../../dev/core/dist/FlowGraph/Blocks/Data/flowGraphTransformCoordinatesSystemBlock.js"],"sourcesContent":["import { FlowGraphBlock } from \"../../flowGraphBlock\";\nimport { RichTypeAny, RichTypeVector3 } from \"../../flowGraphRichTypes\";\nimport { TmpVectors, Vector3 } from \"../../../Maths/math.vector\";\nimport { RegisterClass } from \"../../../Misc/typeStore\";\n/**\n * This blocks transforms a vector from one coordinate system to another.\n */\nexport class FlowGraphTransformCoordinatesSystemBlock extends FlowGraphBlock {\n    /**\n     * Creates a new FlowGraphCoordinateTransformBlock\n     * @param config optional configuration for this block\n     */\n    constructor(config) {\n        super(config);\n        this.sourceSystem = this.registerDataInput(\"sourceSystem\", RichTypeAny);\n        this.destinationSystem = this.registerDataInput(\"destinationSystem\", RichTypeAny);\n        this.inputCoordinates = this.registerDataInput(\"inputCoordinates\", RichTypeVector3);\n        this.outputCoordinates = this.registerDataOutput(\"outputCoordinates\", RichTypeVector3);\n    }\n    _updateOutputs(_context) {\n        const sourceSystemValue = this.sourceSystem.getValue(_context);\n        const destinationSystemValue = this.destinationSystem.getValue(_context);\n        const inputCoordinatesValue = this.inputCoordinates.getValue(_context);\n        // takes coordinates from source space to world space\n        const sourceWorld = sourceSystemValue.getWorldMatrix();\n        // takes coordinates from destination space to world space\n        const destinationWorld = destinationSystemValue.getWorldMatrix();\n        const destinationWorldInverse = TmpVectors.Matrix[0].copyFrom(destinationWorld);\n        // takes coordinates from world space to destination space\n        destinationWorldInverse.invert();\n        const sourceToDestination = TmpVectors.Matrix[1];\n        // takes coordinates from source space to world space to destination space\n        destinationWorldInverse.multiplyToRef(sourceWorld, sourceToDestination);\n        const outputCoordinatesValue = this.outputCoordinates.getValue(_context);\n        Vector3.TransformCoordinatesToRef(inputCoordinatesValue, sourceToDestination, outputCoordinatesValue);\n    }\n    /**\n     * Gets the class name of this block\n     * @returns the class name\n     */\n    getClassName() {\n        return \"FlowGraphTransformCoordinatesSystemBlock\" /* FlowGraphBlockNames.TransformCoordinatesSystem */;\n    }\n}\nRegisterClass(\"FlowGraphTransformCoordinatesSystemBlock\" /* FlowGraphBlockNames.TransformCoordinatesSystem */, FlowGraphTransformCoordinatesSystemBlock);\n//# sourceMappingURL=flowGraphTransformCoordinatesSystemBlock.js.map"],"names":[],"mappings":";;;;;AAIA;AACA;AACA;AACO,MAAM,wCAAwC,SAAS,cAAc,CAAC;AAC7E;AACA;AACA;AACA;AACA,IAAI,WAAW,CAAC,MAAM,EAAE;AACxB,QAAQ,KAAK,CAAC,MAAM,CAAC;AACrB,QAAQ,IAAI,CAAC,YAAY,GAAG,IAAI,CAAC,iBAAiB,CAAC,cAAc,EAAE,WAAW,CAAC;AAC/E,QAAQ,IAAI,CAAC,iBAAiB,GAAG,IAAI,CAAC,iBAAiB,CAAC,mBAAmB,EAAE,WAAW,CAAC;AACzF,QAAQ,IAAI,CAAC,gBAAgB,GAAG,IAAI,CAAC,iBAAiB,CAAC,kBAAkB,EAAE,eAAe,CAAC;AAC3F,QAAQ,IAAI,CAAC,iBAAiB,GAAG,IAAI,CAAC,kBAAkB,CAAC,mBAAmB,EAAE,eAAe,CAAC;AAC9F;AACA,IAAI,cAAc,CAAC,QAAQ,EAAE;AAC7B,QAAQ,MAAM,iBAAiB,GAAG,IAAI,CAAC,YAAY,CAAC,QAAQ,CAAC,QAAQ,CAAC;AACtE,QAAQ,MAAM,sBAAsB,GAAG,IAAI,CAAC,iBAAiB,CAAC,QAAQ,CAAC,QAAQ,CAAC;AAChF,QAAQ,MAAM,qBAAqB,GAAG,IAAI,CAAC,gBAAgB,CAAC,QAAQ,CAAC,QAAQ,CAAC;AAC9E;AACA,QAAQ,MAAM,WAAW,GAAG,iBAAiB,CAAC,cAAc,EAAE;AAC9D;AACA,QAAQ,MAAM,gBAAgB,GAAG,sBAAsB,CAAC,cAAc,EAAE;AACxE,QAAQ,MAAM,uBAAuB,GAAG,UAAU,CAAC,MAAM,CAAC,CAAC,CAAC,CAAC,QAAQ,CAAC,gBAAgB,CAAC;AACvF;AACA,QAAQ,uBAAuB,CAAC,MAAM,EAAE;AACxC,QAAQ,MAAM,mBAAmB,GAAG,UAAU,CAAC,MAAM,CAAC,CAAC,CAAC;AACxD;AACA,QAAQ,uBAAuB,CAAC,aAAa,CAAC,WAAW,EAAE,mBAAmB,CAAC;AAC/E,QAAQ,MAAM,sBAAsB,GAAG,IAAI,CAAC,iBAAiB,CAAC,QAAQ,CAAC,QAAQ,CAAC;AAChF,QAAQ,OAAO,CAAC,yBAAyB,CAAC,qBAAqB,EAAE,mBAAmB,EAAE,sBAAsB,CAAC;AAC7G;AACA;AACA;AACA;AACA;AACA,IAAI,YAAY,GAAG;AACnB,QAAQ,OAAO,0CAA0C;AACzD;AACA;AACA,aAAa,CAAC,0CAA0C,uDAAuD,wCAAwC,CAAC;;;;"}