import{aj as n,ak as u,a4 as c,a3 as d}from"./index-6b43bc24.js";import{G as f}from"./glTFLoader-5bb9d977.js";import"./objectModelMapping-a587b1b7.js";const t="KHR_materials_pbrSpecularGlossiness";class h{constructor(r){this.name=t,this.order=200,this._loader=r,this.enabled=this._loader.isExtensionUsed(t)}dispose(){this._loader=null}loadMaterialPropertiesAsync(r,e,s){return f.LoadExtensionAsync(r,e,this.name,async(i,o)=>{const a=new Array;return a.push(this._loader.loadMaterialBasePropertiesAsync(r,e,s)),a.push(this._loadSpecularGlossinessPropertiesAsync(i,o,s)),this._loader.loadMaterialAlphaProperties(r,e,s),await Promise.all(a).then(()=>{})})}_loadSpecularGlossinessPropertiesAsync(r,e,s){if(!(s instanceof n))throw new Error(`${r}: Material type not supported`);const i=new Array;return s.metallic=null,s.roughness=null,e.diffuseFactor?(s.albedoColor=u.FromArray(e.diffuseFactor),s.alpha=e.diffuseFactor[3]):s.albedoColor=u.White(),s.reflectivityColor=e.specularFactor?u.FromArray(e.specularFactor):u.White(),s.microSurface=e.glossinessFactor==null?1:e.glossinessFactor,e.diffuseTexture&&i.push(this._loader.loadTextureInfoAsync(`${r}/diffuseTexture`,e.diffuseTexture,o=>{o.name=`${s.name} (Diffuse)`,s.albedoTexture=o})),e.specularGlossinessTexture&&(i.push(this._loader.loadTextureInfoAsync(`${r}/specularGlossinessTexture`,e.specularGlossinessTexture,o=>{o.name=`${s.name} (Specular Glossiness)`,s.reflectivityTexture=o,s.reflectivityTexture.hasAlpha=!0})),s.useMicroSurfaceFromReflectivityMapAlpha=!0),Promise.all(i).then(()=>{})}}c(t);d(t,!0,l=>new h(l));export{h as KHR_materials_pbrSpecularGlossiness};
